
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Platform implementation &#8212; Potree-chtemplate 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="References" href="ref.html" />
    <link rel="prev" title="Methodology and data" href="data.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="platform-implementation">
<h1>Platform implementation<a class="headerlink" href="#platform-implementation" title="Permalink to this heading">¶</a></h1>
<p>[testo]</p>
<section id="indoor-navigation">
<h2>Indoor navigation<a class="headerlink" href="#indoor-navigation" title="Permalink to this heading">¶</a></h2>
<p>The exploration of the 3D reconstruction of the indoor portion of Bastione San Giacomo was defined through a series of actions included into annotations.</p>
<img alt="Entry of the indoor portion of San Giacomo Bastion" class="align-center" src="../_images/indoor-entry.jpg" />
<p>In particular, the following actions were implemented:</p>
<ul class="simple">
<li><p>Changing view and scene;</p></li>
<li><p>Showing image pop-up;</p></li>
<li><p>Playing animations.</p></li>
</ul>
<section id="changing-view-and-scene">
<h3>Changing view and scene<a class="headerlink" href="#changing-view-and-scene" title="Permalink to this heading">¶</a></h3>
<p>This action is implemented in the <em>Start exploring!</em> annotation located in the center of the entrance.
Its goal is to trigger the movement from the indoor environment to the outdoor scene.</p>
<p>In order to do so, an input button element is defined in the annotation name.
Then, the action is defined by defining the series of operations to be executed when the button whose name is “outdoor” is clicked by the user.</p>
<img alt="Example of button action for changing view and scene" class="align-center" src="../_images/go-back-outdoor.jpg" />
<p>This event will first call the function <em>changeHotspotName()</em>, changing the hotspot name to the one of the reference point of interest on which the new scene will be focused.
In this case, it will be the outdoor of the San Giacomo bastion. So, the name to be included within the brackets is “San Giacomo”.</p>
<p>Hence, the <em>moveHere()</em> method of the Annotation class is applied to the third element ([2]) of the annotation list defined in the <em>loadannotations.js</em> file.
In this case, it was needed to switch to the camera view defined in the Bastione San Giacomo annotation that was defined as the third in the js file.
By applying this method, the new view will automatically be set considering the coordinates and orientations included in the referred annotation.</p>
<p>Eventually, the visibility of annotations is changed according to the new view.
Consequently, the visible property of all the annotation children defined inside the bastion is set to <em>false</em>, while the one of the new outdoor scene annotations is changed to <em>true</em>.</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span>  ...
{
  // Indoor
  let Titolo4 = $(&#39;<span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span>Start exploring! <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;outdoor&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;Go back outdoor!&quot;</span><span class="p">/&gt;&lt;/</span><span class="nt">span</span> <span class="p">&gt;</span> &#39;)
  Titolo4.find(&quot;input[name=outdoor]&quot;).click((event) =&gt; {
      event.stopPropagation();
      changeHotspotName(&quot;San Giacomo&quot;);
      scenears.annotations.children[2].moveHere(scenears.camera);
      scenears.annotations.children[0].visible = true;
      scenears.annotations.children[1].visible = true;
      scenears.annotations.children[2].visible = true;
      scenears.annotations.children[3].visible = false;
      scenears.annotations.children[4].visible = false;
      scenears.annotations.children[5].visible = false;
      scenears.annotations.children[6].visible = false;
      scenears.annotations.children[7].visible = false;
      scenears.annotations.children[8].visible = false;
      scenears.annotations.children[9].visible = false;
      scenears.annotations.children[10].visible = false;
      scenears.annotations.children[11].visible = false;
      scenears.annotations.children[12].visible = false;
      scenears.annotations.children[13].visible = false;
      scenears.annotations.children[14].visible = false;
      scenears.annotations.children[15].visible = false;
      scenears.annotations.children[16].visible = false;
  });
  Titolo4.toString = () =&gt; &quot;Start exploring!&quot;;
  let nota4 = new Potree.Annotation({
      position: [553471.056, 4988913.293, 95.054],
      title: Titolo4,
      cameraPosition: [553474.7425516201, 4988912.090928567, 96],
      cameraTarget: [553471.056, 4988913.293, 96],
      description: &#39;<span class="p">&lt;</span><span class="nt">b</span><span class="p">&gt;</span>Welcome to the indoor portion of the San Giacomo rampart!<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>----<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>This space is the site of a permanent exhibition of historic cartography and documents about the evolution of the city of Piacenza.<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>You can start exploring the two wings of this space by clicking on the <span class="p">&lt;</span><span class="nt">i</span><span class="p">&gt;</span>&quot;Tour Right&quot;<span class="p">&lt;/</span><span class="nt">i</span><span class="p">&gt;</span> and <span class="p">&lt;</span><span class="nt">i</span><span class="p">&gt;</span>&quot;Tour Left&quot;<span class="p">&lt;/</span><span class="nt">i</span><span class="p">&gt;</span> annotations.<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>The indoor point cloud has been completely acquired through TLS scans with a CAM2 Focus M70.&#39;
  })
  nota4.visible = false;
  scenears.annotations.add(nota4);

}
</pre></div>
</div>
<p>…</p>
</section>
<hr class="docutils" />
<section id="showing-image-pop-up">
<h3>Showing image pop-up<a class="headerlink" href="#showing-image-pop-up" title="Permalink to this heading">¶</a></h3>
<p>The orbit icon included in the indoor annotations is associated to an image detail.
Indeed, after clicking on it, the platform shows a pop up with the image attached to the annotation of interest.
To return to the navigation scene, the user could simply click on the faded area outside the shown image.</p>
<img alt="Example of the image pop-up action on print." class="align-center" src="../_images/indoor-image-pop-up.jpg" />
<p>This action is firstly prepared by definind a div element in the <em>index.html</em> page: it will be the panel that will appear in the middle of the screen when the annotation is clicked.
Inside it, an images tag is defined with the link to the source file path of the image that will be included in the panel when visible.</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!--Paolo III print--&gt;</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;anno8&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;navPanel w3-center w3-animate-opacity&quot;</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;navPanel-content&quot;</span><span class="p">&gt;</span>
              <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;intrinsic-container intrinsic-container-16x9&quot;</span><span class="p">&gt;</span>
                  <span class="p">&lt;</span><span class="nt">img</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;anno_img&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;./assets/anno-img/paoloIII.jpg&quot;</span> <span class="p">/&gt;</span>
              <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
          <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</div>
<hr class="docutils" />
<p>The style for the panel - with rounded corner and position settings - is instead defined in the <em>assets/css/style.css</em> file.</p>
<div class="highlight-css notranslate"><div class="highlight"><pre><span></span><span class="p">.</span><span class="nc">navPanel-content</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="kc">auto</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="kt">%</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">position</span><span class="p">:</span><span class="w"> </span><span class="kc">absolute</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">left</span><span class="p">:</span><span class="w"> </span><span class="mi">9</span><span class="kt">%</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<hr class="docutils" />
<p>Finally, the annotation is defined with its title and action.
The latter one is implemented by including the orbit control icon in the annotation title: this img tag will be the one looked for by the <em>find()</em> method in the next line.
In this way, the click event will first set the camera view in correspondence of the annotation clicked.
Then, the div #anno8 previously defined is retrieved and the <em>.fadeIn()</em> method is applied to it.
In this way, the panel will gradually appear in the middle of the screen and the Potree scene below will appear more opaque.
Similarly, a new click event on the window will trigger the <em>.fadeOut()</em> method applied to the same div element.
Finally, the annotation panel will disappear and the view will return to the previous Potree scene.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="c1">// Paolo III print</span><span class="w"></span>
<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="nx">Titolo16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="sb">`</span>
<span class="sb">          &lt;span&gt;</span>
<span class="sb">              &lt;img src=&quot;./libs/potree/resources/icons/orbit_controls.svg&quot; name=&quot;anno_panel8&quot; class=&quot;annotation-action-icon&quot; &quot;/&gt;</span>
<span class="sb">          &lt;/span&gt;</span>
<span class="sb">      `</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">elAnno10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Titolo16</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;img[name=anno_panel8]&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="nx">elAnno10</span><span class="p">.</span><span class="nx">click</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="nx">scenears</span><span class="p">.</span><span class="nx">annotations</span><span class="p">.</span><span class="nx">children</span><span class="p">[</span><span class="mf">15</span><span class="p">].</span><span class="nx">moveHere</span><span class="p">(</span><span class="nx">scenears</span><span class="p">.</span><span class="nx">camera</span><span class="p">);</span><span class="w"></span>
<span class="w">          </span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#anno8&quot;</span><span class="p">).</span><span class="nx">fadeIn</span><span class="p">();</span><span class="w"></span>
<span class="w">          </span><span class="nx">parentWin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">parent</span><span class="p">;</span><span class="w"></span>
<span class="w">          </span><span class="kd">var</span><span class="w"> </span><span class="nx">sidebar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">parentWin</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;split-container&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">          </span><span class="nx">sidebar</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">opacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;0.2&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="p">});</span><span class="w"></span>
<span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">annoPanel8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;anno8&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="nx">annoPanel8</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#anno8&quot;</span><span class="p">).</span><span class="nx">fadeOut</span><span class="p">();</span><span class="w"></span>
<span class="w">          </span><span class="c1">//reset opacity of parent page</span><span class="w"></span>
<span class="w">          </span><span class="nx">parentWin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">parent</span><span class="p">;</span><span class="w"></span>
<span class="w">          </span><span class="kd">var</span><span class="w"> </span><span class="nx">sidebar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">parentWin</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;split-container&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">          </span><span class="nx">sidebar</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">opacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="p">});</span><span class="w"></span>
<span class="w">      </span><span class="nx">Titolo16</span><span class="p">.</span><span class="nx">toString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;Paolo II print&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="nx">nota16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Potree</span><span class="p">.</span><span class="nx">Annotation</span><span class="p">({</span><span class="w"></span>
<span class="w">          </span><span class="nx">position</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">553468.173</span><span class="p">,</span><span class="w"> </span><span class="mf">4988913.334</span><span class="p">,</span><span class="w"> </span><span class="mf">96.274</span><span class="p">],</span><span class="w"></span>
<span class="w">          </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="nx">Titolo16</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="nx">cameraPosition</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">553470.5484979739</span><span class="p">,</span><span class="mf">4988913.944287285</span><span class="p">,</span><span class="mf">97.04518532773058</span><span class="p">],</span><span class="w"></span>
<span class="w">          </span><span class="nx">cameraTarget</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">553468.173</span><span class="p">,</span><span class="w"> </span><span class="mf">4988913.334</span><span class="p">,</span><span class="w"> </span><span class="mf">96.274</span><span class="p">],</span><span class="w"></span>
<span class="w">          </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&lt;b&gt;Paolo II print&lt;/b&gt;&lt;br&gt;----&lt;br&gt;The Pope is shown seated and flanked by Cardinal Alessandro Farnese as he approves the plan of the castle of Piacenza. The plan is presented to him by Pierluigi, who is kneeling, and is dressed in yellow and blue and has a white mantle. Architecture can be glimpsed in the background.&lt;br&gt;Original paint from 1685 - 1687 by Sebastiano Ricci, preserved at the Civic Museum of the Farnese Palace (Piacenza).&lt;br&gt;----&lt;br&gt;&lt;img src=&quot;assets/anno-img/paoloIII.jpg&quot; alt=&quot;Paolo III Print&quot; title=&quot;Paolo III Print&quot; width=&quot;270px&quot;&gt;&#39;</span><span class="w"></span>
<span class="w">      </span><span class="p">})</span><span class="w"></span>
<span class="w">      </span><span class="nx">nota16</span><span class="p">.</span><span class="nx">visible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="nx">scenears</span><span class="p">.</span><span class="nx">annotations</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">nota16</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="p">...</span><span class="w"></span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="playing-animations">
<h3>Playing animations<a class="headerlink" href="#playing-animations" title="Permalink to this heading">¶</a></h3>
<p>[Testo]</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Potree-chtemplate</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Methodology and data</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Platform implementation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#indoor-navigation">Indoor navigation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ref.html">References</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="data.html" title="previous chapter">Methodology and data</a></li>
      <li>Next: <a href="ref.html" title="next chapter">References</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Federica Gaspari, Francesco Ioli, Federico Barbieri, Clara Rivieri, Michele Dondi, Livio Pinto.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/pages/template-implementation.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>